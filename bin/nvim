#!/bin/bash
# vim: set filetype=sh :

# Purpose: Command for running neovim
#
# Set options:
#   e: Stop script if command fails
#   u: Stop script if unset variable is referenced
#   x: Debug, print commands as they are executed
#set -eu

IMAGENAME=hyshka/neovim

if [[ "$1" = /* ]]; then
  file_name="$(basename ${1})"
  dir_name="$(dirname ${1})"
else
  file_name="$1"
  dir_name="$(pwd)"
fi

# Run the docker command
docker run --userns="host" -i -t -P -v ~/.clipper.sock:/root/.clipper.sock -v "$dir_name":/src $IMAGENAME /bin/sh -c "cd /src;nvim $file_name"
