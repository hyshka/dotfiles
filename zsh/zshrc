#####################
# SETUP ENVIRONMENT #
#####################

# setup paths
GOPATH=$HOME/go
PATH=./node_modules/.bin:$HOME/.rvm/bin:$HOME/.bin:$HOME/.local/bin:$GOPATH/bin:$PATH

# default apps
if (( $+commands[st] )); then
  export TERMINAL=st
else
  export TERMINAL=urxvt
fi
if (( $+commands[docker] )); then
  export VISUAL=nvim
  export EDITOR=nvim
else
  export VISUAL=vim
  export EDITOR=vim
fi
if [ -n "$DISPLAY" ]; then
  export BROWSER=chromium
else
  export BROWSER=w3m
fi

# set default gtk2 theme
export GTK2_RC_FILES="$HOME/.gtkrc-2.0"

# set qt5 to use gtk2 engine
# ref: https://wiki.archlinux.org/index.php/Uniform_look_for_Qt_and_GTK_applications#QGtkStyle
export QT_QPA_PLATFORMTHEME=gtk2

# prevent Firefox from creating Desktop directory
export XDG_DESKTOP_DIR="$HOME/Downloads"

# virtualenv
# lazy loading saves on shell startup time
if [[ -s /usr/bin/virtualenvwrapper.sh ]]; then
  workon() {
    [ -z "$PROJECT_HOME" ] && {
      unset -f workon;
      export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python2
      export WORKON_HOME=$HOME/.virtualenvs
      export PROJECT_HOME=$HOME/Lift
      source /usr/bin/virtualenvwrapper.sh
    }
    workon "$@"
  }
fi

# node version manager
# lazy loading saves on shell startup time
if [[ -s "$HOME/.nvm/nvm.sh" ]]; then
  nvm() {
    unset -f nvm;
    export NVM_DIR="$HOME/.nvm"
    source "$NVM_DIR/nvm.sh"
    nvim "$@"
  }
fi

# ruby version manager
# lazy loading saves on shell startup time
if [[ -s "$HOME/.rvm/scripts/rvm" ]]; then
  rvm() {
    unset -f rvm;
    source "$HOME/.rvm/scripts/rvm"
    rvm "$@"
  }
fi

# Solarized Dircolors
# see: https://github.com/seebi/dircolors-solarized
eval `dircolors $HOME/.dir_colors`

# Base16 Shell
# BASE16_SHELL_SET_BACKGROUND=false
BASE16_SHELL=$HOME/.config/base16-shell/
[ -n "$PS1" ] && [ -s $BASE16_SHELL/profile_helper.sh ] && eval "$($BASE16_SHELL/profile_helper.sh)"

# Set GPG TTY
export GPG_TTY=$(tty)

# Refresh gpg-agent tty in case user switches into an X session
gpg-connect-agent updatestartuptty /bye >/dev/null

# Init FZF
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

# Zim!
if [[ -s ${ZDOTDIR:-${HOME}}/.zim/init.zsh ]]; then
  source ${ZDOTDIR:-${HOME}}/.zim/init.zsh
fi
